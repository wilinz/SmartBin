# 📷 镜头矫正功能使用指南

## 📋 功能概述

SmartBin系统现已集成镜头矫正功能，可以修正鱼眼镜头的畸变效果，提高垃圾识别的准确性。

## 🚀 快速开始

### 1. 启用镜头矫正

1. 打开SmartBin主页面 (`http://localhost:3002`)
2. 在左侧控制面板找到"📹 摄像头控制"部分
3. 点击"镜头矫正"按钮来启用功能
4. 系统会自动加载相机标定参数

### 2. 调节矫正质量

在标定参数加载成功后，您可以调节矫正质量：

- **高质量 (慢)**: 最佳矫正效果，处理较慢
- **中等质量**: 平衡画质与性能
- **低质量 (快)**: 快速处理，画质略低

### 3. 实时预览

启用矫正后，您将看到：

- **实时预览**: 视频画面实时显示矫正效果
- **AI检测**: 检测算法基于矫正后的图像进行分析
- **状态提示**: 显示当前矫正状态和质量设置

## 📊 技术参数

### 相机标定参数

- **图像尺寸**: 640x480 像素
- **焦距**: fx=479.63, fy=474.34
- **光心**: cx=332.92, cy=263.04
- **畸变系数**: 
  - k1 = -0.142
  - k2 = 0.485
  - k3 = -1.353
  - k4 = 1.324

### 性能对比

| 质量设置 | 处理速度 | 画质 | 适用场景 |
|---------|---------|------|---------|
| 高质量 | 慢 (100%) | 最佳 | 精确检测 |
| 中等质量 | 中 (50%) | 良好 | 平衡使用 |
| 低质量 | 快 (33%) | 一般 | 快速预览 |

## 🔧 独立测试

如需独立测试镜头矫正功能：

1. 访问测试页面: `http://localhost:3002/test_calibration.html`
2. 按顺序操作:
   - 启动摄像头
   - 加载标定参数
   - 启用矫正
3. 对比原始和矫正后的图像效果

## 💡 使用建议

### 性能优化

1. **实时检测时**: 建议使用"中等质量"设置
2. **精确检测时**: 使用"高质量"设置
3. **快速预览时**: 使用"低质量"设置

### 最佳实践

1. **首次使用**: 先在测试页面验证矫正效果
2. **性能调优**: 根据设备性能选择合适的质量设置
3. **实时监控**: 观察矫正状态提示确保功能正常

## 🐛 故障排除

### 常见问题

1. **标定参数加载失败**
   - 检查 `web/public/camera_calibration.json` 文件是否存在
   - 确认文件格式正确

2. **矫正效果不佳**
   - 尝试调整矫正质量设置
   - 确认相机参数与实际设备匹配

3. **性能问题**
   - 降低矫正质量设置
   - 检查浏览器性能和内存占用

### 调试模式

打开浏览器开发者工具，查看控制台日志：

```javascript
// 检查标定参数加载
console.log('标定参数:', calibrationParams)

// 检查矫正状态
console.log('矫正启用:', calibrationEnabled)
console.log('矫正质量:', correctionQuality)
```

## 🔄 版本更新

### 当前版本特性

- ✅ 实时预览矫正
- ✅ AI检测矫正
- ✅ 质量调节
- ✅ 性能优化
- ✅ 独立测试页面

### 未来改进

- 🔄 自动质量调节
- 🔄 更多镜头类型支持
- 🔄 GPU加速处理
- 🔄 批量图像处理

## 📞 技术支持

如遇问题，请检查：

1. 浏览器兼容性 (推荐Chrome/Firefox)
2. 相机权限设置
3. 网络连接状态
4. 控制台错误日志

---

*本文档随系统更新而更新，请定期查看最新版本。* 